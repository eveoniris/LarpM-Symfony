{% extends "base.html.twig" %}

{% block title %}Liste des personages de l'utilisateur{% endblock %}


{% block body %}

    {% include '_partials/breadcrumb.twig' with {'items' : [
        {'name' : "Liste des personnages de l'utilisateur" }
    ]} %}

    <div class="well well-sm">

        <div class="header">
            <h5>Liste des personnages</h5>
        </div>

        {% include '_partials/formListSearch.twig' with
            {
                'canAdd': false,
                'actionPath' : path('user.personnage.add', {'user': user.id}),
                'display' : true
            } %}
    </div>

    {% if personnageService.canCreatePersonnage(user) %}
        <div class="d-flex justify-content-end">
            <div class="w-auto mb-2 p-0 btn-toolbar d-flex justify-content-between m-0 p-0" role="toolbar">
                <div class="btn-group m-0 p-0" role="group">
                    {% if personnageService.canCreatePersonnage(user) %}
                        <a class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="bottom"
                       title="Modifier"
                       href="{{ path('user.personnage.add', {'user': user.id}) }}"><i
                            class="fa fa-plus"></i> Ajouter</a>
                    {% endif %}
                    {% if personnageService.hasPersonnages(user) %}
                        <a class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="bottom"
                           title="Choisir le personnage principal actif"
                           href="{{ path('user.personnageDefault', {'user': user.id}) }}"
                        ><span
                                class="fa fa-users" style="margin-right: 5px;"></span>
                            Principal</a>
                    {% endif %}

                </div>
            </div>
        </div>
    {% endif %}

    {% include '_partials/pagination.html.twig' %}

    <table class="table table-striped table-bordered table-condensed table-hover">
        {% include '_partials/thead.twig' with  { 'route': 'user.personnage.list', 'rows': [
            {'name' : '#', 'field' : 'personnage.id', 'css' : 'text-center'},
            {'name' : 'nom', 'field' : 'personnage.nom', 'css' : 'text-center'},
            {'name' : 'surnom', 'field' : 'personnage.surnom', 'css' : 'text-center'},
            {'name' : 'Participations', 'css' : 'text-center'},
        ]} %}
        <tbody>
        {% for personnage in paginator %}
            <tr>
                <td class="text-center"><a href="{{ path('personnage.detail', {"personnage" : personnage.id}) }}">{{ personnage.id }}</a></td>
                <td><a href="{{ path('personnage.detail', {"personnage" : personnage.id}) }}">{{ personnage.nom }}</a></td>
                <td>
                    {% if personnage.surnom %}
                    <a href="{{ path('personnage.detail', {"personnage" : personnage.id}) }}">{{ personnage.surnom }}</a>
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% for participant in personnage.participants %}
                        <strong><a
                                href="{{ path('gn.detail', {'gn': participant.gn.id}) }}">{{ participant.gn.label }}</a></strong>&nbsp;-&nbsp;
                        <a href="{{ path('user.detail', {'user': participant.user.id}) }}">{{ participant.userFullName }}</a>
                        <br/>
                    {% else %}
                        Aucune
                    {% endfor %}
                </td>
            </tr>
        {% else %}
            {% include '_partials/noResultTableRow.twig' %}
        {% endfor %}
        </tbody>
    </table>


    {% include '_partials/pagination.html.twig' %}

{% endblock %}

